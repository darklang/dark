#/usr/bin/env bash

set -euo pipefail

DIR=gcp-builder-dir # used unprotected, dont put a space in the name

# this should eventually run from within the dev container, but that
# doesn't seem easy. So this should run from your mac (or the outer
# container on CI).

cp -f scripts/support/gcp-run-server $DIR/
cp -Rf server/templates $DIR/
cp -Rf scripts $DIR/

mkdir -p $DIR/bin
cp -f server/_build/default/bin/*.exe $DIR/bin/

mkdir -p $DIR/webroot
cp -Rf server/static $DIR/webroot/

docker build -t dark-gcp:latest -f $DIR/Dockerfile $DIR


