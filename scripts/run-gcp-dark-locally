#!/usr/bin/env bash

set -euo pipefail

echo "Killing running containers"
c=$(docker ps --filter "ancestor=dark-gcp:latest" -q)
if [[ ! -z "${c}" ]]; then
  docker kill "${c}";
fi

echo "Starting new container"
docker run \
  --rm \
  -it \
  -p 9000:8000 \
  --env-file config/local_gcp \
  -v pgconf:/etc/postgresql \
  -v pglogs:/var/log/postgresql \
  -v pgdata:/var/lib/postgresql \
  dark-gcp:latest


