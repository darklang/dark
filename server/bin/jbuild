(jbuild_version 1)

(executable
  (
    (name main)
    (public_name main)
    (modules main)
    (flags (-warn-error (+A)))
    (libraries (libbackend))
  )
)

(executable
  (
    (name darkjs)
    (public_name darkjs)
    (modules darkjs)
    (js_of_ocaml ((flags (--opt=1 --source-map --pretty +nat.js))))
    (libraries (js_of_ocaml libanalysis))
    (preprocess (pps (js_of_ocaml-ppx)))
  )
)

(alias
 (
  (name darkjs)
  (deps (darkjs.bc.js))
  (action (system "cp darkjs.bc.js ../../../static/"))))


(executable
  (
    (name darkfile_to_rpc)
    (public_name darkfile_to_rpc)
    (modules darkfile_to_rpc)
    (flags (-warn-error (+A)))
    (libraries (libbackend))
  )
)

(executable
  (
    (name darkfile_db_to_json_file)
    (public_name darkfile_db_to_json_file)
    (modules darkfile_db_to_json_file)
    (flags (-warn-error (+A)))
    (libraries (libbackend))
  )
)

(executable
  (
    (name trigger_queue_workers)
    (public_name trigger_queue_workers)
    (modules trigger_queue_workers)
    (flags (-warn-error (+A)))
    (libraries (libbackend))
  )
)
