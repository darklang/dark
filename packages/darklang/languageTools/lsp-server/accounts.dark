module Darklang.LanguageTools.LspServer.Accounts

let handleListAccountsRequest
  (state: LspState)
  (requestId: JsonRPC.RequestId)
  : LspState =
  let accounts = Builtin.pmListAccounts (())

  let accountsJson =
    accounts
    |> Stdlib.List.map (fun acc -> Stdlib.AltJson.Json.String acc)

  let response =
    (JsonRPC.Response.Ok.make
      (Stdlib.Option.Option.Some requestId)
      (Stdlib.AltJson.Json.Array accountsJson))
    |> Stdlib.AltJson.format

  logAndSendToClient response
  state
