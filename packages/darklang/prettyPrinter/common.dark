// TODO:
//alias PT = PACKAGE.Darklang.LanguageTools.ProgramTypes
//alias RT = PACKAGE.Darklang.Stdlib.RuntimeTypes

module Darklang =
  module PrettyPrinter =
    let indent (s: String) : String =
      s
      |> Builtin.String.split "\n"
      |> PACKAGE.Darklang.Stdlib.List.map (fun line ->
        match line with
        | "" -> ""
        | line -> "  " ++ line)
      |> Builtin.String.join "\n"

    let sign (s: PACKAGE.Darklang.LanguageTools.Sign) : String =
      match s with
      | Positive -> ""
      | Negative -> "-"

    let escapeSpecialCharacters (s: String) : String =
      s
      |> Builtin.String.replaceAll "\n" "\\n"
      |> Builtin.String.replaceAll "\t" "\\t"
      |> Builtin.String.replaceAll "\r" "\\r"

    let processRemainder (remainder: String) : String =
      let rem = $".{remainder}" |> Builtin.Float.parse

      rem
      |> Builtin.unwrap
      |> Builtin.Float.toString
      |> PACKAGE.Darklang.Stdlib.String.dropFirst 2